

# sudo apt install g++-sparc64-linux-gnu qemu-user-static
# ninja -f ./resources/sparc64.ninja
# qemu-sparc64 -L /usr/sparc64-linux-gnu/ ./build/sparc64-forward-backward


cpp = sparc64-linux-gnu-g++
ld = sparc64-linux-gnu-g++
ar = sparc64-linux-gnu-ar

cflags = -c -O3 -I ./library/ -Werror -Wall -Wextra -Wconversion -pedantic -Wold-style-cast


rule Compile
 command = $cpp $cflags $in -o $out
rule Pack
 command = $ar -rcs $out $in
rule Link
 command = $ld $in -o $out


build ./build/sparc64/library/common/conversions.o: Compile ./library/common/conversions.cpp
build ./build/sparc64/library/common/defaults.o:    Compile ./library/common/defaults.cpp
build ./build/sparc64/library/common/essentials.o:  Compile ./library/common/essentials.cpp
build ./build/sparc64/library/common/utilities.o:   Compile ./library/common/utilities.cpp
build ./build/sparc64/library/common/version.o:     Compile ./library/common/version.cpp

build ./build/sparc64/library/decode/compression.o:   Compile ./library/decode/compression.cpp
build ./build/sparc64/library/decode/decode.o:        Compile ./library/decode/decode.cpp
build ./build/sparc64/library/decode/format.o:        Compile ./library/decode/format.cpp
build ./build/sparc64/library/decode/heads.o:         Compile ./library/decode/heads.cpp
build ./build/sparc64/library/decode/lifting.o:       Compile ./library/decode/lifting.cpp
build ./build/sparc64/library/decode/wavelet-haar.o:  Compile ./library/decode/wavelet-haar.cpp
build ./build/sparc64/library/decode/wavelet-cdf53.o: Compile ./library/decode/wavelet-cdf53.cpp

build ./build/sparc64/library/encode/compression.o:   Compile ./library/encode/compression.cpp
build ./build/sparc64/library/encode/encode.o:        Compile ./library/encode/encode.cpp
build ./build/sparc64/library/encode/format.o:        Compile ./library/encode/format.cpp
build ./build/sparc64/library/encode/heads.o:         Compile ./library/encode/heads.cpp
build ./build/sparc64/library/encode/lifting.o:       Compile ./library/encode/lifting.cpp
build ./build/sparc64/library/encode/wavelet-haar.o:  Compile ./library/encode/wavelet-haar.cpp
build ./build/sparc64/library/encode/wavelet-cdf53.o: Compile ./library/encode/wavelet-cdf53.cpp

build ./build/sparc64/tests/forward-backward.o: Compile ./tests/forward-backward.cpp
build ./build/sparc64/tests/wavelet-cdf53.o:    Compile ./tests/wavelet-cdf53.cpp
build ./build/sparc64/tests/wavelet-haar.o:     Compile ./tests/wavelet-haar.cpp


build ./build/sparc64-libako-static.a: Pack $
 ./build/sparc64/library/common/conversions.o $
 ./build/sparc64/library/common/defaults.o $
 ./build/sparc64/library/common/essentials.o $
 ./build/sparc64/library/common/utilities.o $
 ./build/sparc64/library/common/version.o $
 ./build/sparc64/library/decode/compression.o  $
 ./build/sparc64/library/decode/decode.o $
 ./build/sparc64/library/decode/format.o $
 ./build/sparc64/library/decode/heads.o $
 ./build/sparc64/library/decode/lifting.o $
 ./build/sparc64/library/decode/wavelet-haar.o $
 ./build/sparc64/library/decode/wavelet-cdf53.o $
 ./build/sparc64/library/encode/compression.o $
 ./build/sparc64/library/encode/encode.o $
 ./build/sparc64/library/encode/format.o $
 ./build/sparc64/library/encode/heads.o $
 ./build/sparc64/library/encode/lifting.o $
 ./build/sparc64/library/encode/wavelet-haar.o $
 ./build/sparc64/library/encode/wavelet-cdf53.o

build ./build/sparc64-test-forward-backward: Link $
 ./build/sparc64/tests/forward-backward.o $
 ./build/sparc64-libako-static.a

build ./build/sparc64-test-wavelet-cdf53: Link $
 ./build/sparc64/tests/wavelet-cdf53.o $
 ./build/sparc64-libako-static.a

build ./build/sparc64-test-wavelet-haar: Link $
 ./build/sparc64/tests/wavelet-haar.o $
 ./build/sparc64-libako-static.a
